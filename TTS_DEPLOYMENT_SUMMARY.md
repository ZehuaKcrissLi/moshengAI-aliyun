# é­”å£°AI TTSæœåŠ¡éƒ¨ç½²æ€»ç»“

## ğŸ‰ éƒ¨ç½²å®ŒæˆçŠ¶æ€

âœ… **8080 TTSæœåŠ¡å·²æˆåŠŸéƒ¨ç½²åˆ° `moshengai.kcriss.dev/tts`**

## ğŸ“‹ æœåŠ¡ä¿¡æ¯

- **è®¿é—®åœ°å€**: https://moshengai.kcriss.dev/tts/
- **APIåŸºç¡€è·¯å¾„**: https://moshengai.kcriss.dev/tts/
- **å‰ç«¯ç•Œé¢**: ç®€æ´çš„HTMLç•Œé¢ï¼Œæ”¯æŒè¯­éŸ³åˆæˆå’Œè¯•å¬
- **åç«¯æœåŠ¡**: åŸºäºFastAPIçš„TTSæœåŠ¡ï¼Œè¿è¡Œåœ¨8080ç«¯å£

## ğŸ”§ APIæ¥å£ä¸€è‡´æ€§

8080æœåŠ¡çš„APIè°ƒç”¨æ–¹å¼å·²ä¸5173åº”ç”¨ä¿æŒå®Œå…¨ä¸€è‡´ï¼š

### 1. è·å–éŸ³è‰²ç±»å‹
```bash
GET /tts/voice_types
```
**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "voice_types": {
    "ç”·å£°": ["ç”·å£°1å¤§æ°”ç£æ€§", "ç”·å£°2æµ‘åšå¤§æ°”", ...],
    "å¥³å£°": ["å¥³å£°1å¤§æ°”ç£æ€§", "å¥³å£°2çŸ¥æ€§æ¸©æŸ”", ...]
  }
}
```

### 2. å¼‚æ­¥è¯­éŸ³åˆæˆï¼ˆè¯•å¬ï¼‰
```bash
POST /tts/synthesize
Content-Type: multipart/form-data

text=æµ‹è¯•æ–‡æœ¬&gender=å¥³å£°&voice_label=å¥³å£°1å¤§æ°”ç£æ€§
```
**å“åº”**: 202 çŠ¶æ€ç  + ä»»åŠ¡ä¿¡æ¯
```json
{
  "task_id": "uuid",
  "status": "pending",
  "status_url": "/synthesis_tasks/{task_id}/status"
}
```

### 3. ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢
```bash
GET /tts/synthesis_tasks/{task_id}/status
```
**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "completed",
  "result": {
    "success": true,
    "wav_url": "/output/xxx.wav",
    "mp3_url": "/output/xxx.mp3",
    "text": "æµ‹è¯•æ–‡æœ¬"
  }
}
```

### 4. ç¡®è®¤è„šæœ¬ï¼ˆåŒæ­¥åˆæˆï¼‰
```bash
POST /tts/confirm_script
Content-Type: application/json

{
  "text": "æµ‹è¯•æ–‡æœ¬",
  "gender": "å¥³å£°", 
  "voice_label": "å¥³å£°1å¤§æ°”ç£æ€§"
}
```
**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "audio_id": "uuid",
  "wav_url": "/client_output/xxx.wav",
  "mp3_url": "/client_output/xxx.mp3",
  "timestamp": "2025-05-27 02:32:21"
}
```

## ğŸŒ å‰ç«¯ç•Œé¢ç‰¹æ€§

- **å“åº”å¼è®¾è®¡**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **å®æ—¶çŠ¶æ€åé¦ˆ**: æ˜¾ç¤ºåˆæˆè¿›åº¦å’ŒçŠ¶æ€ä¿¡æ¯
- **å¼‚æ­¥è½®è¯¢**: ä¸5173åº”ç”¨ç›¸åŒçš„è½®è¯¢æœºåˆ¶
- **éŸ³é¢‘æ’­æ”¾**: å†…ç½®éŸ³é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒè¯•å¬å’Œä¸‹è½½
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æç¤ºå’ŒçŠ¶æ€ç®¡ç†

## ğŸ”„ ä¸5173åº”ç”¨çš„ä¸€è‡´æ€§

### APIè°ƒç”¨æ–¹å¼
- âœ… ç›¸åŒçš„æ¥å£è·¯å¾„å’Œå‚æ•°
- âœ… ç›¸åŒçš„è¯·æ±‚/å“åº”æ ¼å¼
- âœ… ç›¸åŒçš„å¼‚æ­¥è½®è¯¢æœºåˆ¶
- âœ… ç›¸åŒçš„é”™è¯¯å¤„ç†é€»è¾‘

### å‰ç«¯äº¤äº’
- âœ… è¯•å¬æŒ‰é’®ä½¿ç”¨å¼‚æ­¥è½®è¯¢
- âœ… ç¡®è®¤æŒ‰é’®ä½¿ç”¨åŒæ­¥æ¥å£
- âœ… ç›¸åŒçš„çŠ¶æ€ç®¡ç†å’Œç”¨æˆ·åé¦ˆ
- âœ… ç›¸åŒçš„éŸ³é¢‘URLå¤„ç†é€»è¾‘

## ğŸš€ éƒ¨ç½²æ¶æ„

```
ç”¨æˆ·è¯·æ±‚ â†’ Nginx â†’ TTSæœåŠ¡(8080ç«¯å£)
                â†“
            é™æ€æ–‡ä»¶æœåŠ¡
            éŸ³é¢‘æ–‡ä»¶æœåŠ¡
            APIæ¥å£æœåŠ¡
```

### Nginxé…ç½®
- **è·¯å¾„ä»£ç†**: `/tts/` â†’ `localhost:8080/`
- **é™æ€æ–‡ä»¶**: éŸ³é¢‘æ–‡ä»¶ã€å‰ç«¯èµ„æº
- **HTTPSæ”¯æŒ**: è‡ªåŠ¨SSLè¯ä¹¦
- **CORSé…ç½®**: æ”¯æŒè·¨åŸŸè¯·æ±‚

## ğŸ“Š æµ‹è¯•ç»“æœ

æ‰€æœ‰APIæ¥å£æµ‹è¯•é€šè¿‡ï¼š
- âœ… voice_types æ¥å£: æ­£å¸¸ (181ä¸ªéŸ³è‰²)
- âœ… å¼‚æ­¥åˆæˆæ¥å£: æ­£å¸¸ (202çŠ¶æ€ç )
- âœ… ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢: æ­£å¸¸ (è½®è¯¢æœºåˆ¶)
- âœ… ç¡®è®¤è„šæœ¬æ¥å£: æ­£å¸¸ (åŒæ­¥åˆæˆ)

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### ç›´æ¥è®¿é—®
1. æ‰“å¼€ https://moshengai.kcriss.dev/tts/
2. è¾“å…¥è¦åˆæˆçš„æ–‡æœ¬
3. é€‰æ‹©æ€§åˆ«å’ŒéŸ³è‰²
4. ç‚¹å‡»"è¯•å¬"è¿›è¡Œé¢„è§ˆæˆ–"ç¡®è®¤ä½¿ç”¨"ç”Ÿæˆæœ€ç»ˆéŸ³é¢‘

### APIé›†æˆ
```javascript
// è·å–éŸ³è‰²ç±»å‹
const voiceTypes = await fetch('/tts/voice_types').then(r => r.json());

// å¼‚æ­¥åˆæˆï¼ˆè¯•å¬ï¼‰
const formData = new FormData();
formData.append('text', 'æµ‹è¯•æ–‡æœ¬');
formData.append('gender', 'å¥³å£°');
formData.append('voice_label', 'å¥³å£°1å¤§æ°”ç£æ€§');

const response = await fetch('/tts/synthesize', {
    method: 'POST',
    body: formData
});

// è½®è¯¢çŠ¶æ€
const taskInfo = await response.json();
// ... è½®è¯¢é€»è¾‘

// ç¡®è®¤è„šæœ¬ï¼ˆåŒæ­¥ï¼‰
const result = await fetch('/tts/confirm_script', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        text: 'æµ‹è¯•æ–‡æœ¬',
        gender: 'å¥³å£°',
        voice_label: 'å¥³å£°1å¤§æ°”ç£æ€§'
    })
});
```

## ğŸ”§ ç»´æŠ¤è¯´æ˜

### æœåŠ¡ç®¡ç†
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
pm2 status

# é‡å¯TTSæœåŠ¡
pm2 restart tts-service

# æŸ¥çœ‹æ—¥å¿—
pm2 logs tts-service
```

### æ–‡ä»¶è·¯å¾„
- **å‰ç«¯æ–‡ä»¶**: `/mnt/moshengAI/static/index.html`
- **éŸ³é¢‘è¾“å‡º**: `/mnt/moshengAI/output/` (è¯•å¬)
- **æœ€ç»ˆéŸ³é¢‘**: `/mnt/moshengAI/client_output/` (ç¡®è®¤)
- **é…ç½®æ–‡ä»¶**: `/etc/nginx/conf.d/moshengai.conf`

---

**ğŸŠ éƒ¨ç½²æˆåŠŸï¼8080æœåŠ¡ç°åœ¨å¯ä»¥é€šè¿‡ `moshengai.kcriss.dev/tts` è®¿é—®ï¼ŒAPIè°ƒç”¨æ–¹å¼ä¸5173åº”ç”¨å®Œå…¨ä¸€è‡´ã€‚** 